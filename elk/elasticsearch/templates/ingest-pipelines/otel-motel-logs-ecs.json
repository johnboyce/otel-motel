{
  "description": "Remap OpenTelemetry log Attributes and Resource fields to ECS fields and remove redundant fields",
  "processors": [
    { "set": { "field": "ecs.version", "value": "8.11.0" } },
    { "set": { "field": "process.thread.name", "value": "{{Attributes.thread.name}}", "if": "ctx.Attributes != null && ctx.Attributes.thread != null && ctx.Attributes.thread.name != null" } },
    { "set": { "field": "process.thread.id", "value": "{{Attributes.thread.id}}", "if": "ctx.Attributes != null && ctx.Attributes.thread != null && ctx.Attributes.thread.id != null" } },
    { "set": { "field": "log.logger", "value": "{{Attributes.log.logger.namespace}}", "if": "ctx.Attributes != null && ctx.Attributes.log != null && ctx.Attributes.log.logger != null && ctx.Attributes.log.logger.namespace != null" } },
    { "set": { "field": "event.code", "value": "{{Attributes.code.function}}", "if": "ctx.Attributes != null && ctx.Attributes.code != null && ctx.Attributes.code.function != null" } },
    { "set": { "field": "event.action", "value": "{{Attributes.code.function}}", "if": "ctx.Attributes != null && ctx.Attributes.code != null && ctx.Attributes.code.function != null" } },
    { "set": { "field": "event.dataset", "value": "{{Attributes.code.namespace}}", "if": "ctx.Attributes != null && ctx.Attributes.code != null && ctx.Attributes.code.namespace != null" } },
    { "set": { "field": "log.origin.file.line", "value": "{{Attributes.code.lineno}}", "if": "ctx.Attributes != null && ctx.Attributes.code != null && ctx.Attributes.code.lineno != null" } },
    { "set": { "field": "log.origin.function", "value": "{{Attributes.code.function}}", "if": "ctx.Attributes != null && ctx.Attributes.code != null && ctx.Attributes.code.function != null" } },
    { "set": { "field": "log.origin.file.name", "value": "{{Attributes.code.namespace}}", "if": "ctx.Attributes != null && ctx.Attributes.code != null && ctx.Attributes.code.namespace != null" } },
    { "set": { "field": "labels.parent_id", "value": "{{Attributes.parentId}}", "if": "ctx.Attributes != null && ctx.Attributes.parentId != null" } },
    { "set": { "field": "host.name", "value": "{{Resource.host.name}}", "if": "ctx.Resource != null && ctx.Resource.host != null && ctx.Resource.host.name != null" } },
    { "set": { "field": "service.name", "value": "{{Resource.service.name}}", "if": "ctx.Resource != null && ctx.Resource.service != null && ctx.Resource.service.name != null" } },
    { "set": { "field": "service.version", "value": "{{Resource.service.version}}", "if": "ctx.Resource != null && ctx.Resource.service != null && ctx.Resource.service.version != null" } },
    { "set": { "field": "service.environment", "value": "{{Resource.deployment.environment}}", "if": "ctx.Resource != null && ctx.Resource.deployment != null && ctx.Resource.deployment.environment != null" } },
    { "set": { "field": "trace.id", "value": "{{TraceId}}", "if": "ctx.TraceId != null" } },
    { "set": { "field": "span.id", "value": "{{SpanId}}", "if": "ctx.SpanId != null" } },
    { "set": { "field": "log.level", "value": "{{SeverityText}}", "if": "ctx.SeverityText != null" } },
    { "set": { "field": "message", "value": "{{Body}}", "if": "ctx.Body != null" } },
    { "set": { "field": "event.original", "value": "{{Body}}", "if": "ctx.Body != null" } },
    { "set": { "field": "error.message", "value": "{{Attributes.error.message}}", "if": "ctx.Attributes != null && ctx.Attributes.error != null && ctx.Attributes.error.message != null" } },
    { "set": { "field": "error.stack_trace", "value": "{{Attributes.error.stack_trace}}", "if": "ctx.Attributes != null && ctx.Attributes.error != null && ctx.Attributes.error.stack_trace != null" } },
    { "set": { "field": "error.type", "value": "{{Attributes.error.type}}", "if": "ctx.Attributes != null && ctx.Attributes.error != null && ctx.Attributes.error.type != null" } },
    { "remove": { "field": "TraceId", "ignore_missing": true } },
    { "remove": { "field": "SpanId", "ignore_missing": true } },
    { "remove": { "field": "Body", "ignore_missing": true } },
    { "remove": { "field": "SeverityText", "ignore_missing": true } },
    { "remove": { "field": "Resource", "ignore_missing": true } },
    { "remove": { "field": "Attributes", "ignore_missing": true } }
  ]
}
