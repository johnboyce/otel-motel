# Application Configuration
quarkus.application.name=otel-motel

# DynamoDB Configuration
quarkus.dynamodb.endpoint-override=http://localhost:4566
quarkus.dynamodb.aws.region=us-east-1
quarkus.dynamodb.region=us-east-1

quarkus.dynamodb.aws.credentials.type=static
dynamodb.aws.credentials.static-provider.type=static
quarkus.dynamodb.aws.credentials.static-provider.access-key-id=test
quarkus.dynamodb.aws.credentials.static-provider.secret-access-key=test

# OpenTelemetry OTLP Exporter Configuration
quarkus.otel.exporter.otlp.endpoint=http://localhost:4318
quarkus.otel.exporter.otlp.protocol=http/protobuf

# Enable tracing
# quarkus.otel.traces.enabled is deprecated; use quarkus.opentelemetry.enabled instead or remove if not needed
# quarkus.otel.traces.enabled=true
quarkus.otel.traces.sampler=always_on

# Enable metrics
quarkus.otel.metrics.enabled=true

# Enable logs (for log correlation)
quarkus.otel.logs.enabled=true

# Resource attributes
quarkus.otel.resource.attributes=service.name=otel-motel,service.version=1.0-SNAPSHOT,deployment.environment=dev

# Logging Configuration - ECS JSON format for Elasticsearch
quarkus.log.console.json.enabled=true
quarkus.log.console.json.log-format=ecs
quarkus.log.console.json.pretty-print=false
quarkus.log.level=INFO
quarkus.log.category."com.johnnyb".level=DEBUG

# GraphQL Configuration
quarkus.smallrye-graphql.ui.always-include=true
quarkus.smallrye-graphql.print-data-fetcher-exception=true

# Security Configuration
# Enable OIDC for JWT token validation
quarkus.oidc.enabled=true
quarkus.oidc.auth-server-url=http://localhost:8180/realms/otel-motel
quarkus.oidc.client-id=otel-motel-client
quarkus.oidc.credentials.secret=secret
quarkus.oidc.tls.verification=none

# JWT Configuration
mp.jwt.verify.publickey.location=http://localhost:8180/realms/otel-motel/protocol/openid-connect/certs
mp.jwt.verify.issuer=http://localhost:8180/realms/otel-motel

# Security policy
quarkus.http.auth.policy.read-policy.roles-allowed=user,admin
quarkus.http.auth.policy.write-policy.roles-allowed=admin

# Allow unauthenticated access to GraphQL UI and schema for development
quarkus.http.auth.permission.public.paths=/q/graphql-ui,/q/graphql-ui/*,/graphql/schema.graphql
quarkus.http.auth.permission.public.policy=permit
quarkus.http.auth.permission.authenticated.paths=/graphql
quarkus.http.auth.permission.authenticated.policy=authenticated

# Development profile - disable security for local testing
%dev.quarkus.oidc.enabled=false
%dev.quarkus.security.auth.enabled-in-dev-mode=false

# Test profile - use mock security
%test.quarkus.oidc.enabled=false
%test.quarkus.security.auth.enabled-in-dev-mode=false
